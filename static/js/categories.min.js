!function(){"use strict";const e={colorInput:null,previewElement:null,paletteContainer:null,suggestedColors:[],init(e){if(!e)return;this.colorInput=e;const t=e.dataset.suggestedColors;if(t)try{this.suggestedColors=JSON.parse(t)}catch(e){console.warn("Failed to parse suggested colors:",e),this.suggestedColors=[]}this.createPreview(),this.createPalette(),this.addEventListeners(),this.updatePreview()},createPreview(){const e=document.getElementById("colorPreview");if(e)return void(this.previewElement=e);this.colorInput.closest(".color-picker-wrapper")||this.colorInput.parentElement;const t=document.createElement("div");t.className="flex items-center gap-3 mt-2",this.previewElement=document.createElement("div"),this.previewElement.id="colorPreview",this.previewElement.className="w-10 h-10 rounded-lg border-2 border-slate-600 shadow-inner",this.previewElement.style.backgroundColor=this.colorInput.value||"#3B82F6";const o=document.createElement("span");o.className="color-code text-slate-300 font-mono text-sm",o.textContent=this.colorInput.value||"#3B82F6",t.appendChild(this.previewElement),t.appendChild(o),this.colorInput.parentElement.appendChild(t)},createPalette(){const e=document.querySelectorAll(".color-option");if(e.length>0)return this.paletteContainer=e[0].closest(".bg-slate-900")||e[0].parentElement,void e.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const o=e.dataset.color;o&&this.selectColor(o)})});if(0===this.suggestedColors.length)return;const t=this.colorInput.closest(".color-picker-wrapper")||this.colorInput.parentElement;this.paletteContainer=document.createElement("div"),this.paletteContainer.className="mt-3";const o=document.createElement("p");o.className="text-sm text-slate-400 mb-2",o.textContent="Cores sugeridas:";const r=document.createElement("div");r.className="flex flex-wrap gap-2",this.suggestedColors.forEach(e=>{const t=document.createElement("button");t.type="button",t.className="color-option w-8 h-8 rounded-lg border-2 border-slate-600 hover:border-slate-400 transition-all duration-200 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 focus:ring-offset-slate-800",t.style.backgroundColor=e,t.title=e,t.dataset.color=e,t.addEventListener("click",()=>{this.selectColor(e)}),r.appendChild(t)}),this.paletteContainer.appendChild(o),this.paletteContainer.appendChild(r),t.appendChild(this.paletteContainer)},addEventListeners(){this.colorInput.addEventListener("input",()=>{this.updatePreview()}),this.colorInput.addEventListener("change",()=>{this.updatePreview()})},updatePreview(){const e=this.colorInput.value||"#3B82F6";this.previewElement&&(this.previewElement.style.backgroundColor=e);const t=this.previewElement?.parentElement.querySelector(".color-code");t&&(t.textContent=e.toUpperCase()),this.updatePaletteActiveState(e)},selectColor(e){this.colorInput.value=e,this.updatePreview();const t=new Event("change",{bubbles:!0});this.colorInput.dispatchEvent(t)},updatePaletteActiveState(e){(this.paletteContainer?this.paletteContainer.querySelectorAll("button, .color-option"):document.querySelectorAll(".color-option")).forEach(t=>{const o=t.dataset.color;o&&o.toUpperCase()===e.toUpperCase()?t.classList.add("ring-2","ring-primary-600"):t.classList.remove("ring-2","ring-primary-600")})}},t={modal:null,init(){this.modal||(this.modal=document.createElement("div"),this.modal.id="category-delete-modal",this.modal.className="fixed inset-0 z-50 hidden",this.modal.innerHTML='\n        \x3c!-- Backdrop --\x3e\n        <div class="fixed inset-0 bg-black/70 backdrop-blur-sm transition-opacity" onclick="CategoryDeleteModal.close()"></div>\n\n        \x3c!-- Modal Content --\x3e\n        <div class="fixed inset-0 flex items-center justify-center p-4">\n          <div class="bg-slate-800 rounded-xl shadow-2xl border border-red-600/30 max-w-md w-full transform transition-all scale-95 opacity-0" id="category-delete-modal-content">\n            \x3c!-- Icon --\x3e\n            <div class="flex items-center justify-center w-16 h-16 mx-auto mt-8 bg-red-900/30 rounded-full">\n              <svg class="w-8 h-8 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>\n              </svg>\n            </div>\n\n            \x3c!-- Content --\x3e\n            <div class="p-8 text-center">\n              <h3 class="text-2xl font-bold text-slate-100 mb-3">Excluir Categoria</h3>\n              <p class="text-slate-300 mb-2" id="category-delete-modal-message">\n                Tem certeza que deseja excluir esta categoria?\n              </p>\n              <p class="text-slate-400 text-sm">\n                Esta ação não pode ser desfeita.\n              </p>\n            </div>\n\n            \x3c!-- Actions --\x3e\n            <div class="flex gap-3 px-8 pb-8">\n              <button type="button"\n                      onclick="CategoryDeleteModal.close()"\n                      class="flex-1 px-6 py-3 bg-slate-700 hover:bg-slate-600 text-slate-100 font-medium rounded-lg border border-slate-600 transition-all duration-200">\n                Cancelar\n              </button>\n              <button type="button"\n                      id="category-delete-modal-confirm"\n                      class="flex-1 px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-medium rounded-lg shadow-lg hover:shadow-xl transition-all duration-200">\n                Excluir\n              </button>\n            </div>\n          </div>\n        </div>\n      ',document.body.appendChild(this.modal),document.addEventListener("keydown",e=>{"Escape"!==e.key||this.modal.classList.contains("hidden")||this.close()}))},show(e,t,o){this.init();const r=document.getElementById("category-delete-modal-message");r&&(r.innerHTML=`\n          Tem certeza que deseja excluir a categoria\n          <span class="inline-flex items-center px-2 py-1 rounded text-sm font-medium mx-1" style="background-color: ${t}20; color: ${t}">\n            <span class="w-2 h-2 rounded-full mr-1.5" style="background-color: ${t}"></span>\n            ${e}\n          </span>?\n        `);const n=document.getElementById("category-delete-modal-confirm"),s=n.cloneNode(!0);n.parentNode.replaceChild(s,n),s.addEventListener("click",()=>{o&&o(),this.close()}),this.modal.classList.remove("hidden"),setTimeout(()=>{const e=document.getElementById("category-delete-modal-content");e.classList.remove("scale-95","opacity-0"),e.classList.add("scale-100","opacity-100")},10)},close(){const e=document.getElementById("category-delete-modal-content");e&&(e.classList.add("scale-95","opacity-0"),e.classList.remove("scale-100","opacity-100")),setTimeout(()=>{this.modal&&this.modal.classList.add("hidden")},200)}},o={init(e){if(!e)return;const t=e.querySelector("#id_name"),o=e.querySelector("#id_category_type"),r=e.querySelector("#id_color");t&&(t.addEventListener("blur",()=>{this.validateName(t)}),t.addEventListener("input",()=>{this.clearError(t)})),r&&r.addEventListener("change",()=>{this.validateColor(r)}),e.addEventListener("submit",e=>{let n=!0;t&&!this.validateName(t)&&(n=!1),o&&!o.value&&(n=!1,this.showError(o,"Selecione o tipo da categoria.")),r&&!this.validateColor(r)&&(n=!1),n||e.preventDefault()})},validateName(e){const t=e.value.trim();return t?t.length<2?(this.showError(e,"O nome deve ter pelo menos 2 caracteres."),!1):t.length>50?(this.showError(e,"O nome não pode ter mais de 50 caracteres."),!1):(this.showSuccess(e),!0):(this.showError(e,"O nome da categoria é obrigatório."),!1)},validateColor(e){const t=e.value.trim().toUpperCase();return t?/^#[0-9A-F]{6}$/.test(t)?(this.showSuccess(e),!0):(this.showError(e,"Cor inválida. Use o formato #RRGGBB."),!1):(this.showError(e,"Selecione uma cor para a categoria."),!1)},showSuccess(e){this.clearError(e),e.classList.add("border-green-500")},showError(e,t){this.clearError(e),e.classList.add("border-red-500");const o=document.createElement("div");o.className="field-error mt-2",o.innerHTML=`\n        <p class="text-sm text-red-400 flex items-center">\n          <svg class="w-4 h-4 mr-1" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">\n            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z" />\n          </svg>\n          ${t}\n        </p>\n      `;(e.closest(".relative")||e.parentElement).appendChild(o)},clearError(e){e.classList.remove("border-red-500","border-green-500");const t=(e.closest(".relative")||e.parentElement).querySelector(".field-error");t&&t.remove()}};document.addEventListener("DOMContentLoaded",()=>{const r=document.querySelector("#id_color");r&&e.init(r);const n=document.querySelector('form[method="post"]');n&&o.init(n);document.querySelectorAll('a[href*="/excluir/"]').forEach(e=>{e.addEventListener("click",o=>{o.preventDefault();const r=e.closest("[data-category-name]"),n=r?.dataset.categoryName||"esta categoria",s=r?.dataset.categoryColor||"#6366F1";t.show(n,s,()=>{window.location.href=e.href})})})}),window.ColorPicker=e,window.CategoryDeleteModal=t,window.CategoryFormValidator=o}();